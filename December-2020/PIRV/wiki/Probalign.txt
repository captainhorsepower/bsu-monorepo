Probalign
Probalign is a sequence alignment tool that calculates a maximum expected accuracy alignment using partition function posterior probabilities Base pair probabilities are estimated using an estimate similar to Boltzmann distribution The partition function is calculated using a dynamic programming approach Algorithm The following describes the algorithm used by probalign to determine the base pair probabilities Alignment score To score an alignment of two sequences two things are needed a similarity function x y displaystyle sigma x y e g PAM BLOSUM affine gap penalty g k k displaystyle g k alpha beta k The score S a displaystyle S a of an alignment a is defined as S a x i y j a x i y j gap cost displaystyle S a sum x i y j in a sigma x i y j text gap cost Now the boltzmann weighted score of an alignment a is e S a T e x i y j a x i y j gap cost T x i y i a e x i y j T e g a p c o s t T displaystyle e frac S a T e frac sum x i y j in a sigma x i y j text gap cost T left prod x i y i in a e frac sigma x i y j T right cdot e frac gapcost T Where T displaystyle T is a scaling factor The probability of an alignment assuming boltzmann distribution is given by P r a x y e S a T Z displaystyle Pr a x y frac e frac S a T Z Where Z displaystyle Z is the partition function i e the sum of the boltzmann weights of all alignments Dynamic Programming Let Z i j displaystyle Z i j denote the partition function of the prefixes x 0 x 1 x i displaystyle x 0 x 1 x i and y 0 y 1 y j displaystyle y 0 y 1 y j Three different cases are considered Z i j M displaystyle Z i j M the partition function of all alignments of the two prefixes that end in a match Z i j I displaystyle Z i j I the partition function of all alignments of the two prefixes that end in an insertion y j displaystyle y j Z i j D displaystyle Z i j D the partition function of all alignments of the two prefixes that end in a deletion x i displaystyle x i Then we have Z i j Z i j M Z i j D Z i j I displaystyle Z i j Z i j M Z i j D Z i j I Initialization The matrixes are initialized as follows Z 0 j M Z i 0 M 0 displaystyle Z 0 j M Z i 0 M 0 Z 0 0 M 1 displaystyle Z 0 0 M 1 Z 0 j D 0 displaystyle Z 0 j D 0 Z i 0 I 0 displaystyle Z i 0 I 0 Recursion The partition function for the alignments of two sequences x displaystyle x and y displaystyle y is given by Z x y displaystyle Z x y which can be recursively computed Z i j M Z i 1 j 1 e x i y j T displaystyle Z i j M Z i 1 j 1 cdot e frac sigma x i y j T Z i j D Z i 1 j D e T Z i 1 j M e g 1 T Z i 1 j I e g 1 T displaystyle Z i j D Z i 1 j D cdot e frac beta T Z i 1 j M cdot e frac g 1 T Z i 1 j I cdot e frac g 1 T Z i j I displaystyle Z i j I analogously Base pair probability Finally the probability that positions x i displaystyle x i and y j displaystyle y j form a base pair is given by P x i y j x y Z i 1 j 1 e x i y j T Z i j Z x y displaystyle P x i y j x y frac Z i 1 j 1 cdot e frac sigma x i y j T cdot Z i j Z x y Z i j displaystyle Z i j are the respective values for the recalculated Z displaystyle Z with inversed base pair strings See also ProbCons Multiple Sequence Alignment References External links Probalign Webservice