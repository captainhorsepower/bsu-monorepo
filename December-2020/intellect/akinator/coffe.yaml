definitions:
  крема:
    description: |-
      пенка на поверности эспрессо
      формируется во время экстракции эспрессо 

      Цитата: “Попадая в чашку, жидкость оказывается в условиях 
        нормального атмосферного давления и не в состоянии 
        удерживать газ, который выходит в виде тысячи пузырьков. 
        Они и формируют плотную пенку”.
      
      О чём крема нам говорит?
      что кофе свеж и хорошо экстрагирован и что бариста контролирует кофе.
  
  латте-арт:
    description: |-
      Это способ вливания молока в эспрессо, благодаря которому 
      на поверхности получаются узоры. 
      Так же можно просто рисовать острым предметом на верхнем слое пены.
  
      Требует чёткого соблюдения пропорций молока и кофе.


  coffe-params:
  - name: основа 
    сам себе основа: &based-on-self
      основа: cам себе основа
    эспрессо: &based-on-espresso
      основа: эспрессо
    двойной эспрессо: &based-on-double-espresso
      основа: двойной эспрессо
    любой кофе без молока: &based-on-any-black-coffe
      основа: любой чёрный кофе

  - name: добавка к кофе
    чистый кофе: &with-none
      добвка к основе: без добавки.
    горячая вода: &with-hot-water
      добвка к основе: вода ~ 90 градусов
    взбитое молоко: &with-milk-to-coffe
      добвка к основе: взбитое молоко 60-70 градусов добавляется в кофе
      дополнительно:
        - молоко 60-70 градусов
        - молоко в кофе
    кофе макиато:  &with-milk-macciato
      добвка к основе: молочная пенка
      дополнительно:
        - 10-15 мл молока для пенки
        - при взбитии разогревается до 60 градусов
        - выкладывается в центр эспрессо

    

  - name: пенка
    крема: &penka-krema
      пенка: крема
    капучино пенка: &penka-cappuccino
      пенка: толстая и густая молочная пенка
    латте пенка: &penka-latte
      пенка: средняя по толщине и неочень густая молочная пенка
    флэт уайт пенка: &penka-flat-white
      пенка: тонка плоская молочная пенка
    макиато: &penka-macciato
      пенка: молочная пенка выкладывается ложечкой в центр напитка


  - name: объём
    эспрессо: &vol-espresso-shot
      объём: 25-30 мл
    американо: &vol-americano
      объём: 200-300 мл
    капучино: &vol-cappuccino
      объём: 150-200 мл
    латте: &vol-latte
      объём: 200-300 мл
    макиато: &vol-macciato
      объём: 45-65 мл


  - name: посуда
    чашечка эспрессо: &cup-espresso
      посуда: чашчека для эспрессо
    просто чашка: &cup
      посуда: чашка
    стакан: &cup-irish-glass-or-large-cup
      посуда: айриш бокал или большая чашка, стакан
    подогретая чашка: &cup-warmed-up
      посуда: подогретая чашка

  - name: время приготовления
    эспрессо: &time-20-30-sec
      время приготовления: 20-30 сек
    капучино: &time-1-2-min
      время приготовления: 1-2 минуты
    латте: &time-3-8-min
      время приготовления: 3-8 минут
    флэт уайт: &time-5-min
      время приготовления: 5 минут
    макиато: &time-3-5-min
      время приготовления: 3-5 минут


  - name: температура готового
    горячий: &temp-espresso
      температура готового напитка: 85-95 градусов
    капучино: &temp-cappuccino
      температура готового напитка: 60-70 градусов


  посуда-params:
  - name: чашечка эспрессо
    attrs:
    - маленькая чашечка
    - внутрия имеет форму яйца
    - это позволяет максимально сохранить плотность и пенку при наливании в чашку.
    - катекогрически не квадратная

  - name: просто чашка

        

name: Кофе
default-target:
rules:

- then:
  - вид: эспрессо
  when: &sample-when
    and: 
    - *based-on-self
    - *with-none
    - *penka-krema
    - *cup-espresso
    - *vol-espresso-shot
    - *time-20-30-sec
    - *temp-espresso 
    - вкус: горкий, насыщенный

- then:
  - вид: макиато
  when: 
    and:
    - *based-on-espresso
    - *with-milk-macciato
    - *penka-macciato
    - *vol-macciato
    - *cup-espresso
    - *temp-cappuccino
    - *time-3-5-min 

- name: сам себе основа => без добавок
  when:
    and: 
    - *based-on-self
  then:
    - *with-none

- name: объём из посуды
  when:
    and:
    - *cup-espresso
    - *with-none
  then: 
  - *vol-espresso-shot

- name: объём из посуды
  when:
    and:
    - *cup-espresso
    - *with-milk-macciato
  then: 
  - *vol-macciato

- then:
  - вид: американо
  when: 
    and:
    - *based-on-double-espresso
    - *with-hot-water
    - *penka-krema
    - *vol-americano
    - *cup
    - *temp-espresso
    - *time-20-30-sec
    - вкус: нерезкий, деликатный 

- then:
  - вид: капучино
  when: 
    and:
    - *based-on-any-black-coffe
    - *with-milk-to-coffe
    - *penka-cappuccino
    - *vol-cappuccino
    - *cup-warmed-up
    - *time-1-2-min 
    - *temp-cappuccino 
    - вкус: идеальный баланс молока и кофе.


- then:
  - вид: латте
  when:
    and:
    - *based-on-any-black-coffe
    - *with-milk-to-coffe
    - *penka-latte
    - *vol-latte
    - *cup-irish-glass-or-large-cup
    - *temp-cappuccino
    - *time-3-8-min 
    - вкус: нежный, лёгкий, кофейно сливочный

- then:
  - вид: флэт уайт
  when: 
    and:
    - *based-on-double-espresso
    - *with-milk-to-coffe
    - *penka-flat-white
    - *vol-cappuccino
    - *cup-warmed-up
    - *time-5-min 
    - *temp-cappuccino
    - вкус: яркий кофейный вкус

# FIXME
- then:
  - вид: раф
  when:
    and:
    - сахар: ванильный
    - сливки: да, взбитые паром
    - эспрессо: в сливки (и сироп?) добавляют шот
    - придумали: в москве
    - посуда: прогрета, чашка или высокий бокал
    - пенка: воздушная, глянцевая
    - объём: 124-160 мл
    - время приготовления: 5-10 минут 
    - комфортная температура: 50-60 градусов
    - приготовление:
      - смешать сливки и сахар 
      - залить к ним кофе
      - взбить смесь пароотводом
      - перелить в посуду, украсить и подать

# FIXME
- then:
  - вид: моккачино
  when: 
    and:
    - объём: 160-170 мл 
    - время приготовления: 15-20 минут 
    - температура: 50-60 градусов 
    - разновидность латте: да, с добавлением шоколада
    - шоколад: обычно порошок какао, можно и сироп
    - посуда: высокий прозрачный бокал, потому что красиво
    - приготовление: 
      - растопить 50г шоколада с ложкой молока, вылить в бокал 
      - сварить 50г кофе, перелить в бокал, не перемешивать
      - взбить холодное молоко капучинатором
      - перелить молоко по лезвию ножа в кофе 
      - взбить сливки в крутую пену, выложить
      - посыпать тёртым шоколадом 

# FIXME
- then:
  - вид: латте макиато
  when: 
    and:
    - молоко и пена: больше молока, чем пены?
    - посуда: irish бокал
    - слои: чётко видны тир слоя 
    - время приготовления: 3-8 минут 
    - температура: 60-70 градусов 
    - объём: 240 мл
    - основа: любой чёрный кофе
    - приготоволение: 
      - в молоко вливают кофе (3:1)
      - молоко и кофе лежат слоями
      
# FIXME
- then:
  - вид: ирландский кофе
  when:
    and:
    - время приготовления: 7-10 минут 
    - объём: 150-160 
    - ирладнский виски: да
    - кофе: чёрный
    - сахар: коричневый
    - взбитые сливки: да
    - эспрессо: крепкий
    - посуда: бокал, ополоснутый кипятком
    - приготоволение: 
      - взбить сливки заранее
      - сварить эспрессо
      - полоснуть бокал кипятком
      - положить в бокал сахар
      - залить горячим эспрессо, перемешать 
      - добавить виски 
      - осторожно влить сливки
  
